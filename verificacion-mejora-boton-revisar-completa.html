<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verificaci√≥n: Bot√≥n Revisar y Di√°logo Mejorado</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8fafc;
        }
        
        .verification-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-pending { background: #f3f4f6; color: #374151; }
        .status-review { background: #fef3c7; color: #92400e; }
        .status-completed { background: #d1fae5; color: #065f46; }
        
        .review-button {
            background: #f97316;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
        }
        
        .review-button:hover {
            background: #ea580c;
        }
        
        .review-button:disabled {
            background: #d1d5db;
            cursor: not-allowed;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        th, td {
            text-align: left;
            padding: 8px 12px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        th {
            background: #f9fafb;
            font-weight: 600;
        }
        
        .dialog-preview {
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            background: #fafafa;
            margin-top: 15px;
        }
        
        .info-card {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 6px;
            padding: 12px;
            margin: 10px 0;
        }
        
        .info-card.student {
            background: #f0fdf4;
            border-color: #bbf7d0;
        }
        
        .info-card.grading {
            background: #fff7ed;
            border-color: #fed7aa;
        }
        
        .grade-scale {
            background: #e5e7eb;
            border-radius: 10px;
            height: 8px;
            margin: 10px 0;
            position: relative;
        }
        
        .grade-fill {
            background: #10b981;
            height: 100%;
            border-radius: 10px;
            width: 85%;
        }
        
        .file-item {
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 12px;
            margin: 8px 0;
            display: flex;
            justify-content: between;
            align-items: center;
        }
        
        .check {
            color: #10b981;
            font-weight: bold;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .feature-list li:last-child {
            border-bottom: none;
        }
        
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üîç Verificaci√≥n: Bot√≥n "Revisar" y Di√°logo Mejorado</h1>
    <p><strong>Fecha:</strong> <span id="current-date"></span></p>
    
    <div class="verification-section">
        <h2>‚úÖ Panel de Estudiantes - Estado Din√°mico</h2>
        <p>El panel ahora refleja el estado real de las entregas:</p>
        
        <table>
            <thead>
                <tr>
                    <th>Estudiante</th>
                    <th>Estado</th>
                    <th>Calificaci√≥n</th>
                    <th>Fecha Entrega</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Juan P√©rez</td>
                    <td><span class="status-badge status-pending">Pendiente</span></td>
                    <td><em>Sin entregar</em></td>
                    <td>-</td>
                    <td><span style="color: #9ca3af;">Sin entrega</span></td>
                </tr>
                <tr>
                    <td>Mar√≠a Gonz√°lez</td>
                    <td><span class="status-badge status-review">En Revisi√≥n</span></td>
                    <td><em>Sin calificar</em></td>
                    <td>15 dic 2024, 14:30</td>
                    <td><button class="review-button">Revisar</button></td>
                </tr>
                <tr>
                    <td>Carlos L√≥pez</td>
                    <td><span class="status-badge status-completed">Finalizado</span></td>
                    <td><strong>85/100</strong></td>
                    <td>14 dic 2024, 18:45</td>
                    <td><button class="review-button">Editar</button></td>
                </tr>
            </tbody>
        </table>
        
        <div style="margin-top: 15px; padding: 10px; background: #ecfdf5; border-radius: 6px;">
            <p class="check">‚úì Estados actualizados din√°micamente basados en entregas reales</p>
            <p class="check">‚úì Bot√≥n "Revisar" habilitado solo con entregas v√°lidas</p>
            <p class="check">‚úì Fechas de entrega reales mostradas</p>
        </div>
    </div>

    <div class="verification-section">
        <h2>üîß Mejoras Implementadas en el C√≥digo</h2>
        <ul class="feature-list">
            <li><strong>getStudentTaskStatus():</strong> L√≥gica din√°mica para determinar estado real</li>
            <li><strong>getStudentSubmission():</strong> Recuperaci√≥n de datos de entrega reales</li>
            <li><strong>handleReviewSubmission():</strong> Validaci√≥n de entregas antes de abrir di√°logo</li>
            <li><strong>Panel actualizado:</strong> Sin l√≥gica hardcodeada, uso de datos reales</li>
            <li><strong>Eventos en tiempo real:</strong> Actualizaci√≥n autom√°tica cuando se entrega</li>
        </ul>
    </div>

    <div class="verification-section">
        <h2>üìã Di√°logo de Revisi√≥n Mejorado</h2>
        <p>Vista previa del di√°logo de revisi√≥n con todas las caracter√≠sticas implementadas:</p>
        
        <div class="dialog-preview">
            <h3 style="margin-top: 0;">Revisar Entrega - Mar√≠a Gonz√°lez</h3>
            
            <div class="info-card">
                <h4>üìå Informaci√≥n de la Tarea</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 14px;">
                    <div>
                        <p><strong>T√≠tulo:</strong> Ensayo de Historia</p>
                        <p><strong>Curso:</strong> 3¬∫ ESO A</p>
                        <p><strong>Materia:</strong> Historia</p>
                    </div>
                    <div>
                        <p><strong>Fecha l√≠mite:</strong> 16 dic 2024, 23:59</p>
                        <p><strong>Prioridad:</strong> <span class="status-badge" style="background: #fee2e2; color: #991b1b;">Alta</span></p>
                    </div>
                </div>
            </div>
            
            <div class="info-card student">
                <h4>üë®‚Äçüéì Informaci√≥n del Estudiante y Entrega</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 14px;">
                    <div>
                        <p><strong>Nombre:</strong> Mar√≠a Gonz√°lez</p>
                        <p><strong>ID:</strong> maria.gonzalez</p>
                        <p><strong>Hora de entrega:</strong> 15 dic 2024, 14:30</p>
                    </div>
                    <div>
                        <p><strong>Fecha completa:</strong> domingo, 15 de diciembre de 2024, 14:30:25</p>
                        <p><strong>Tiempo transcurrido:</strong> Hace 1 d√≠a y 2 horas</p>
                        <p><strong>Estado actual:</strong> <span class="status-badge status-review">En Revisi√≥n</span></p>
                    </div>
                </div>
            </div>
            
            <div style="background: #f9fafb; padding: 12px; border-radius: 6px; margin: 10px 0;">
                <h4>üí¨ Contenido de la Entrega</h4>
                <div style="background: white; padding: 12px; border-radius: 4px; border: 1px solid #e5e7eb;">
                    <p style="margin: 0; font-size: 14px;">He completado el ensayo sobre la Revoluci√≥n Industrial siguiendo las pautas establecidas. He incluido an√°lisis de las causas, desarrollo y consecuencias del per√≠odo hist√≥rico...</p>
                </div>
            </div>
            
            <div style="background: #faf5ff; padding: 12px; border-radius: 6px; margin: 10px 0; border: 1px solid #e9d5ff;">
                <h4>üìé Archivos Adjuntos de la Entrega (2)</h4>
                <div class="file-item">
                    <div>
                        <p style="margin: 0; font-weight: 500;">üìÑ ensayo_revolucion_industrial.docx</p>
                        <p style="margin: 0; font-size: 12px; color: #6b7280;">Tama√±o: 2.4 MB ‚Ä¢ Subido: 15 dic 2024, 14:30</p>
                    </div>
                    <button style="background: #3b82f6; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 12px;">Ver/Descargar</button>
                </div>
                <div class="file-item">
                    <div>
                        <p style="margin: 0; font-weight: 500;">üìä grafico_datos_industriales.xlsx</p>
                        <p style="margin: 0; font-size: 12px; color: #6b7280;">Tama√±o: 856 KB ‚Ä¢ Subido: 15 dic 2024, 14:30</p>
                    </div>
                    <button style="background: #3b82f6; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 12px;">Ver/Descargar</button>
                </div>
            </div>
            
            <div class="info-card grading">
                <h4>‚≠ê Calificaci√≥n y Retroalimentaci√≥n</h4>
                
                <div style="margin: 15px 0;">
                    <label style="display: block; font-weight: 500; margin-bottom: 8px;">üéØ Calificaci√≥n (0-100) *</label>
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <input type="number" value="85" style="width: 80px; padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; text-align: center; font-weight: bold;">
                        <span style="font-size: 16px;">/ 100</span>
                        <span class="status-badge" style="background: #d1fae5; color: #065f46;">‚úÖ Aprobado</span>
                    </div>
                    
                    <div class="grade-scale">
                        <div class="grade-fill"></div>
                    </div>
                    
                    <div style="display: flex; justify-between; font-size: 11px; color: #6b7280; margin-top: 5px;">
                        <span>Insuficiente</span>
                        <span>Regular</span>
                        <span>Bueno</span>
                        <span>Muy Bueno</span>
                        <span>Excelente</span>
                    </div>
                </div>
                
                <div>
                    <label style="display: block; font-weight: 500; margin-bottom: 8px;">üí¨ Retroalimentaci√≥n para el Estudiante</label>
                    <textarea style="width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; resize: none;" rows="3" placeholder="Escribe aqu√≠ tu retroalimentaci√≥n...">Excelente trabajo, Mar√≠a. El ensayo demuestra una comprensi√≥n profunda del tema y el an√°lisis es muy completo. Los gr√°ficos complementan muy bien el texto.</textarea>
                </div>
            </div>
            
            <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px; padding-top: 15px; border-top: 1px solid #e5e7eb;">
                <button style="background: white; color: #f97316; border: 1px solid #f97316; padding: 8px 16px; border-radius: 4px;">Cancelar</button>
                <button style="background: #f97316; color: white; border: none; padding: 8px 16px; border-radius: 4px; font-weight: 500;">Guardar Calificaci√≥n</button>
            </div>
        </div>
    </div>

    <div class="verification-section">
        <h2>üöÄ Caracter√≠sticas Implementadas</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <div>
                <h3>Panel de Estudiantes</h3>
                <ul class="feature-list">
                    <li>‚úÖ Estado din√°mico basado en datos reales</li>
                    <li>‚úÖ Fecha de entrega real mostrada</li>
                    <li>‚úÖ Bot√≥n "Revisar" habilitado correctamente</li>
                    <li>‚úÖ Actualizaci√≥n en tiempo real</li>
                    <li>‚úÖ Sin l√≥gica hardcodeada</li>
                </ul>
            </div>
            <div>
                <h3>Di√°logo de Revisi√≥n</h3>
                <ul class="feature-list">
                    <li>‚úÖ Informaci√≥n completa del estudiante</li>
                    <li>‚úÖ Detalles de la entrega con timestamps</li>
                    <li>‚úÖ Archivos adjuntos con descarga</li>
                    <li>‚úÖ Sistema de calificaci√≥n visual</li>
                    <li>‚úÖ Campo de retroalimentaci√≥n</li>
                    <li>‚úÖ Estados visuales claros</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="verification-section">
        <h2>üìù Flujo de Trabajo Profesor</h2>
        <div style="background: #f8fafc; padding: 15px; border-radius: 6px; border-left: 4px solid #3b82f6;">
            <ol style="margin: 0; padding-left: 20px;">
                <li><strong>Estudiante entrega tarea:</strong> Estado cambia a "En Revisi√≥n" autom√°ticamente</li>
                <li><strong>Profesor ve la entrega:</strong> Bot√≥n "Revisar" se habilita y muestra fecha real</li>
                <li><strong>Profesor abre di√°logo:</strong> Ve todos los detalles de la entrega completos</li>
                <li><strong>Profesor revisa archivos:</strong> Puede descargar/ver todos los adjuntos</li>
                <li><strong>Profesor califica:</strong> Asigna nota (0-100) y retroalimentaci√≥n</li>
                <li><strong>Estado final:</strong> Cambia a "Finalizado" y se muestra la calificaci√≥n</li>
            </ol>
        </div>
    </div>

    <div class="verification-section">
        <h2>üîß Cambios T√©cnicos Realizados</h2>
        <div class="code-block">
// Antes: L√≥gica hardcodeada
if (student.displayName === 'Maria Estudiante') {
  // l√≥gica espec√≠fica para Mar√≠a
}

// Despu√©s: L√≥gica din√°mica
let submission = getStudentSubmission(selectedTask.id, student.id);
let studentStatus = getStudentTaskStatus(selectedTask.id, student.id);
const hasSubmission = submission !== undefined;

// Estado basado en datos reales
{studentStatus === 'pending' ? 'Pendiente' : 
 studentStatus === 'delivered' ? 'En Revisi√≥n' : 
 'Finalizado'}
        </div>
        
        <p><strong>Archivos modificados:</strong></p>
        <ul>
            <li><code>/src/app/dashboard/tareas/page.tsx</code> - Panel principal y di√°logo de revisi√≥n</li>
            <li>Funciones de estado y validaci√≥n mejoradas</li>
            <li>Sistema de eventos para actualizaciones en tiempo real</li>
        </ul>
    </div>

    <div class="verification-section" style="background: #f0fdf4; border: 1px solid #bbf7d0;">
        <h2 style="color: #065f46;">‚úÖ Estado: COMPLETADO</h2>
        <p style="color: #166534; margin: 0;">
            Todas las mejoras solicitadas han sido implementadas exitosamente. El sistema ahora maneja din√°micamente los estados de las entregas, 
            proporciona un di√°logo de revisi√≥n completo y mantiene la funcionalidad actualizada en tiempo real.
        </p>
    </div>

    <script>
        document.getElementById('current-date').textContent = new Date().toLocaleString('es-ES', {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });
    </script>
</body>
</html>
